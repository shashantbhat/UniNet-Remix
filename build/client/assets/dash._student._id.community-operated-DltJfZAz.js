import{j as e,r as l,f as S}from"./index-TckX4F0b.js";import{u as C}from"./components-D27kuvza.js";const A=({tags:c,selectedTags:o,onSelectTag:x})=>e.jsxs("div",{className:"absolute top-full left-0 mt-2 w-full bg-white border border-gray-300 rounded-xl text-sm shadow-lg z-50",children:[e.jsx("div",{className:"flex items-center px-2 pt-4",children:e.jsx("span",{className:"font-medium",children:"Search using tags:"})}),e.jsx("ul",{className:"flex flex-wrap py-2",children:c.map(r=>e.jsx("li",{className:`px-3 py-1 m-1 hover:bg-gray-400 bg-gray-200 cursor-pointer rounded-full ${o.includes(r.id)?"bg-gray-400":""}`,onClick:()=>x(r.id),children:r.name},r.id))})]}),H=({tags:c,isOpen:o,onClose:x})=>{const[r,p]=l.useState([]),[h,u]=l.useState({}),d=s=>{p(a=>a.includes(s)?a.filter(n=>n!==s):[...a,s])},b=(s,a)=>{u(n=>({...n,[s]:a}))};return o?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-1/3",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Advanced Search"}),e.jsx("hr",{}),e.jsx("h1",{className:"text-xl font-semibold mb-4 pt-4",children:"Enter Prompt (AI Tag Analysis)"}),e.jsx("form",{children:e.jsx("div",{className:"flex items-center mb-2 w-full",children:e.jsx("input",{type:"text",className:"rounded-xl bg-gray-100 w-full h-auto p-3 text-sm font-medium focus:outline-none focus:ring-1 focus:ring-black transition-all hover:border-black duration-200",placeholder:"Enter prompt"})})}),e.jsx("h1",{className:"text-xl font-semibold mb-4 pt-4",children:"Search using tags:"}),e.jsxs("form",{children:[e.jsx("div",{className:"flex flex-wrap",children:c.map(s=>e.jsx("div",{className:"flex items-center mb-2",children:e.jsx("div",{className:`px-3 py-1 m-1 hover:bg-gray-400 bg-gray-200 cursor-pointer rounded-full ${r.includes(s.id)?"bg-gray-400":""}`,onClick:()=>d(s.id),children:s.name})},s.id))}),e.jsx("hr",{}),e.jsx("div",{className:"mt-4",children:r.map(s=>{const a=c.find(n=>n.id===s);return e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:"w-1/2",children:e.jsx("span",{className:" mr-2 px-3 py-1 bg-gray-200 cursor-pointer rounded-full",children:a==null?void 0:a.name})}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:h[s]||0,onChange:n=>b(s,parseFloat(n.target.value)),className:"slider ml-2"}),e.jsx("span",{className:"ml-2",children:h[s]||0})]},s)})}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{type:"button",className:"border border-black bg-white text-black px-4 py-2 rounded-xl hover:bg-black hover:text-white transition",onClick:x,children:"Close"})})]})]})}):null},Z=()=>{const{files:c,tags:o,fileTagAssignments:x}=C(),[r,p]=l.useState(""),[h,u]=l.useState(!1),[d,b]=l.useState([]),[s,a]=l.useState(!1),{id:n}=S(),f=l.useRef(null),v=t=>{p(t.target.value)},N=()=>{u(!h)},j=t=>{b(m=>m.includes(t)?m.filter(i=>i!==t):[...m,t])},w=t=>{f.current&&!f.current.contains(t.target)&&u(!1)};l.useEffect(()=>(document.addEventListener("mousedown",w),()=>{document.removeEventListener("mousedown",w)}),[]);const g=c==null?void 0:c.filter(t=>{const m=x.filter(i=>i.file_id===t.id).map(i=>i.tag_id);return t.title.toLowerCase().includes(r.toLowerCase())&&(d.length===0||d.every(i=>m.includes(i)))}),[y,k]=l.useState(!1);return l.useEffect(()=>{k(!0)},[]),e.jsxs("div",{className:"flex flex-col h-screen p-4",children:[e.jsxs("div",{className:`flex flex-col gap-4 bg-gray-100 bg-opacity-75 rounded-3xl shadow-lg p-6 w-full transition-opacity duration-1000 ${y?"opacity-100":"opacity-0"}`,children:[e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsxs("button",{className:"flex items-center gap-2 border border-black bg-white text-black hover:bg-black hover:text-white py-2.5 px-4 rounded-xl text-sm font-medium transition",onClick:()=>{window.location.href=`/dash/${n}/upload-material`},children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",viewBox:"0 0 256 256",children:e.jsx("path",{d:"M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,216H56V40h88V88a8,8,0,0,0,8,8h48V216Zm-40-64a8,8,0,0,1-8,8H136v16a8,8,0,0,1-16,0V160H104a8,8,0,0,1,0-16h16V128a8,8,0,0,1,16,0v16h16A8,8,0,0,1,160,152Z"})}),e.jsx("span",{children:"Add File"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{className:"flex items-center gap-2 border border-black bg-white text-black hover:bg-black hover:text-white py-2.5 px-4 rounded-xl text-sm font-medium transition",onClick:()=>a(!0),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",viewBox:"0 0 256 256",children:e.jsx("path",{d:"M32,64a8,8,0,0,1,8-8H216a8,8,0,0,1,0,16H40A8,8,0,0,1,32,64Zm8,72h72a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16Zm88,48H40a8,8,0,0,0,0,16h88a8,8,0,0,0,0-16Zm109.66,13.66a8,8,0,0,1-11.32,0L206,177.36A40,40,0,1,1,217.36,166l20.3,20.3A8,8,0,0,1,237.66,197.66ZM184,168a24,24,0,1,0-24-24A24,24,0,0,0,184,168Z"})}),e.jsx("span",{children:"Adv Search"})]}),e.jsxs("div",{ref:f,className:"relative flex items-center gap-2 w-1/3 min-w-[400px]",children:[e.jsx("input",{type:"text",placeholder:"Search files",value:r,onChange:v,onClick:N,className:"w-full py-2.5 px-4 rounded-xl text-sm font-medium focus:outline-none focus:ring-1 focus:ring-black transition-all hover:border-black duration-200"}),h&&e.jsx(A,{tags:o,selectedTags:d,onSelectTag:j})]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("table",{className:"min-w-full bg-white table-fixed",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"h-12",children:[" ",e.jsx("th",{className:"py-2 px-4 border-b text-center w-40",children:"File Name"}),e.jsx("th",{className:"py-2 px-4 border-b text-center w-64",children:"Description"}),e.jsx("th",{className:"py-2 px-4 border-b text-center w-36",children:"Upload Date"}),e.jsx("th",{className:"py-2 px-4 border-b text-center w-32",children:"Average Rating"})]})}),e.jsx("tbody",{children:g==null?void 0:g.map(t=>e.jsxs("tr",{className:"h-10",children:[" ",e.jsx("td",{className:"py-2 px-2 border-b text-center w-40 truncate",children:e.jsx("a",{href:`/dash/id/files/${t.id}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-black",children:t.title})}),e.jsx("td",{className:"py-2 px-2 border-b text-center w-64",children:e.jsx("span",{className:"line-clamp-1",children:t.description})}),e.jsx("td",{className:"py-2 px-2 border-b text-center w-36 truncate",children:new Date(t.upload_date).toLocaleDateString()}),e.jsxs("td",{className:"py-2 px-2 border-b text-center w-32 truncate",children:[t.average_rating.toFixed(1)," â˜…"]})]},t.id))})]})})]}),e.jsx(H,{tags:o,selectedTags:d,onSelectTag:j,isOpen:s,onClose:()=>a(!1)})]})};export{Z as default};
